{"version":3,"file":"SystemFields.js","names":["Schema"],"sources":["../../../src/api/SystemFields.ts"],"sourcesContent":["import type {\n  Expand,\n  IdField,\n  SystemFields as NonIdSystemFields,\n} from \"convex/server\";\nimport { Schema } from \"effect\";\nimport * as GenericId from \"./GenericId\";\n\ntype SystemFieldsSchema<TableName extends string> = Schema.Struct<{\n  _id: Schema.Schema<\n    GenericId.GenericId<TableName>,\n    GenericId.GenericId<TableName>,\n    never\n  >;\n  _creationTime: typeof Schema.Number;\n}>;\n\n/**\n * Produces a schema for Convex system fields.\n */\nexport const SystemFields = <TableName extends string>(\n  tableName: TableName,\n): SystemFieldsSchema<TableName> =>\n  Schema.Struct({\n    _id: GenericId.GenericId(tableName),\n    _creationTime: Schema.Number,\n  });\n\n/**\n * Extend a table schema with Convex system fields.\n */\nexport const extendWithSystemFields = <\n  TableName extends string,\n  TableSchema extends Schema.Schema.AnyNoContext,\n>(\n  tableName: TableName,\n  schema: TableSchema,\n): ExtendWithSystemFields<TableName, TableSchema> =>\n  Schema.extend(SystemFields(tableName), schema);\n\n/**\n * Extend a table schema with Convex system fields at the type level.\n */\nexport type ExtendWithSystemFields<\n  TableName extends string,\n  TableSchema extends Schema.Schema.AnyNoContext,\n> = Schema.extend<SystemFieldsSchema<TableName>, TableSchema>;\n\nexport type WithSystemFields<TableName extends string, Document> = Expand<\n  Readonly<IdField<TableName>> & Readonly<NonIdSystemFields> & Document\n>;\n"],"mappings":";;;;;;;;;;;;AAoBA,MAAa,gBACX,cAEAA,cAAO,OAAO;CACZ,qCAAyB,UAAU;CACnC,eAAeA,cAAO;CACvB,CAAC;;;;AAKJ,MAAa,0BAIX,WACA,WAEAA,cAAO,OAAO,aAAa,UAAU,EAAE,OAAO"}